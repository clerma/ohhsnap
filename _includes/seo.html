{%- assign title_separator = site.title_separator | default: '|' -%}
{%- if page.title -%}{%- assign seo_title = page.title | append: " " | append: title_separator | append: " " | append: site.name -%}{%- else -%}{%- assign seo_title = site.name -%}{%- endif -%}

{%- assign canonical_url = page.canonical_url | default: page.url | absolute_url -%}
{%- if page.description -%}{%- assign seo_description = page.description -%}{%- elsif page.excerpt -%}{%- assign seo_description = page.excerpt -%}{%- else -%}{%- assign seo_description = site.description -%}{%- endif -%}

{%- assign page_image = page.image | default: site.og_image | absolute_url -%}
{%- assign og_type = page.date | default: "website" -%}

<title>{{ seo_title }}</title>
{% if page.nofollow == 'true' %}<meta name="robots" content="noindex" />{% else %}<meta name="robots" content="index, follow" />{% endif %}
{% assign canonical_url = page.url | absolute_url %}
<link rel="canonical" href="{{ canonical_url }}">
<meta property="og:url" content="{{ canonical_url }}">

<!-- Meta Tags -->
<meta name="description" content="{{ seo_description }}">
<meta name="author" content="{{ site.author }}">
<!-- Open Graph -->
<meta property="og:type" content="{{ og_type }}">
<meta property="og:locale" content="{{ site.locale | default: 'en_US' }}">
<meta property="og:site_name" content="{{ site.name }}">
<meta property="og:title" content="{{ seo_title }}">
<meta property="og:description" content="{{ seo_description }}">
<meta property="og:image" content="{{ page_image | absolute_url }}">
<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@{{ site.twitter.username }}">
<meta name="twitter:title" content="{{ seo_title }}">
<meta name="twitter:description" content="{{ seo_description }}">
<meta name="twitter:image" content="{{ page_image | absolute_url }}">

<!-- Social Links -->
{% for link in site.social.links %}<meta property="og:see_also" content="{{ link }}">{% endfor %}
{% assign canonical_url = page.url | absolute_url %}

<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"LocalBusiness",
  "@id":"{{ site.url | default: canonical_url | append: '/#localbusiness' | replace: '//', '/' | replace: ':/', '://' }}",
  "name":"{{ site.name | escape }}",
  "description":"{{ site.description | default: seo_description | strip_html | strip_newlines | escape }}",
  "image":"{{ page_image | absolute_url }}",
  "logo":"{{ site.logo | absolute_url }}",
  "url":"{{ canonical_url }}",
  "mainEntityOfPage":{"@type":"WebPage","@id":"{{ canonical_url }}"},
  "telephone":"{{ site.phone }}",
  "email":"{{ site.email }}",
  "address":{
    "@type":"PostalAddress",
    "streetAddress":"{{ site.address.street | escape }}",
    "addressLocality":"{{ site.address.city | escape }}",
    "addressRegion":"{{ site.address.region | escape }}",
    "postalCode":"{{ site.address.zip | escape }}",
    "addressCountry":"{{ site.address.country | escape }}"
  },
  "geo":{
    "@type":"GeoCoordinates",
    "latitude":{{ site.latitude }},
    "longitude":{{ site.longitude }}
  },
  "areaServed":[
    {% for city in site.local_keywords %}
    {"@type":"City","name":"{{ city | strip | escape }}","addressRegion":"{{ site.address.region | escape }}","addressCountry":"{{ site.address.country | escape }}"}{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ],
  "serviceArea":{
    "@type":"GeoCircle",
    "geoMidpoint":{"@type":"GeoCoordinates","latitude":{{ site.latitude }},"longitude":{{ site.longitude }}},
    "geoRadius": {{ site.service_radius_meters | default: 64374 }}
  },
  "openingHoursSpecification":[
    {"@type":"OpeningHoursSpecification","dayOfWeek":["Monday","Tuesday","Wednesday","Thursday","Friday"],"opens":"09:00","closes":"17:00"},
    {"@type":"OpeningHoursSpecification","dayOfWeek":["Saturday","Sunday"],"opens":"10:00","closes":"17:00"}
  ],
  "priceRange":"{{ site.price_range | default: '$$' }}",
  "paymentAccepted": [{% if site.payment_accepted %}{% for p in site.payment_accepted %}"{{ p | strip | escape }}"{% unless forloop.last %},{% endunless %}{% endfor %}{% else %}"Cash","Credit Card","PayPal","Check"{% endif %}],
  "sameAs":[
    {% for link in site.social.links %}
    "{{ link }}"{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ]
}
</script>

<!-- Verification -->
{% if site.google_site_verification %}<meta name="google-site-verification" content="{{ site.google_site_verification }}">{% endif %}
{% if site.bing_site_verification %}<meta name="msvalidate.01" content="{{ site.bing_site_verification }}">{% endif %}
<meta name="p:domain_verify" content="f97ad618eec84c888b80593b09758148"/>
